"undefined"==typeof toolkit&&(toolkit={}),toolkit.skycons=function(){function e(){var e,t=document,n=(t.documentElement,t.body),i=!1,o=t.createElement("p"),a=t.createElement("style"),s='#testbefore:before { content: "before"; }';return a.type="text/css",o.id="testbefore",a.styleSheet?a.styleSheet.cssText=s:a.appendChild(t.createTextNode(s)),n.appendChild(a),n.appendChild(o),e=t.getElementById("testbefore").offsetHeight,e>=1&&(i=!0),n.removeChild(a),n.removeChild(o),i}function t(e,t){var n=e.innerHTML,o=i[t];e.innerHTML='<span style="font-family: \'skycons\'" class="ie7-skycon">'+o+"</span>"+n}function n(){if(!e()){var n,i,o,a=document.getElementsByTagName("*");for(n=0;o=a[n],o;n+=1)i=o.className,i=i.match(/skycon-[^\s'"]+/),i&&t(o,i[0])}}var i={"skycon-sky":"&#xf100;","skycon-twitter-reply":"&#xf101;","skycon-chevron":"&#xf102;","skycon-facebook":"&#xf103;","skycon-remote-record":"&#xf104;","skycon-warning":"&#xf105;","skycon-carousel-play":"&#xf106;","skycon-user-profile":"&#xf107;","skycon-search":"&#xf108;","skycon-twitter-retweet":"&#xf109;","skycon-volume":"&#xf10a;","skycon-twitter-favourite":"&#xf10b;","skycon-expand":"&#xf10c;","skycon-carousel-pause":"&#xf10d;","skycon-share":"&#xf10e;","skycon-never-miss":"&#xf10f;","skycon-mail":"&#xf110;","skycon-sky-go":"&#xf111;","skycon-twitter-follow":"&#xf112;","skycon-minify":"&#xf113;","skycon-twitter":"&#xf114;","skycon-close":"&#xf115;","skycon-menu":"&#xf116;","skycon-google-plus":"&#xf117;"};return{add:t,init:n}}(),"function"==typeof window.define&&window.define.amd&&define("utils/skycons",[],function(){return toolkit.skycons}),"undefined"==typeof toolkit&&(toolkit={}),toolkit.hashmanager=function(){function e(){$(window).on("hashchange",t);var e=document.documentMode,n="onhashchange"in window&&(void 0===e||e>7);n||(s.hash=document.location.hash,setInterval(function(){document.location.hash!==s.hash&&$(window).trigger("hashchange")},200)),s.windowLoaded=!0}function t(e){var t,n;e=a("string"==typeof e?e:location.hash),e?(t=s.globalHashList[e],n="callback",s.lastExecutor=e):s.lastExecutor&&(t=s.globalHashList[s.lastExecutor],n="undo"),t&&"function"==typeof t[n]&&t[n](e)}function n(){var e=window.location;"pushState"in history?(location.hash="!",history.pushState("",document.title,e.pathname+e.search)):location.hash="!"}function i(e){location.hash="!"+e}function o(e,n,i){var o=s.globalHashList;$(e).each(function(e,r){if(r=a(r),o[r]){var c="hashManager: hash ("+r+") already exists";throw new Error(c)}o[r]={callback:n,undo:i},s.windowLoaded&&r===a(location.hash)&&t(r)})}function a(e){return e.replace(/[#!]/g,"")}var s={globalHashList:{},hasLoaded:!1,windowLoaded:!1,lastExecutor:null,hash:null};return e(),{register:o,change:i,remove:n,onHashChange:t,cleanHash:a}}(),"function"==typeof window.define&&window.define.amd&&define("utils/hashmanager",[],function(){return toolkit.hashmanager}),"undefined"==typeof toolkit&&(toolkit={}),toolkit.popup=function(){function e(e){var t=e.url,n=e.width||400,i=e.height||n,o=e.top||screen.height/2-i/2,a=e.left||screen.width/2-n/2,s=e.title||"Sky";return window.open(t,s,"top="+o+",left="+a+",width="+n+",height="+i)}function t(){$("body").on("click","[data-popup]",function(t){t.preventDefault();var n=$.extend($(this).data("popup"),{url:$(this).attr("href")});e(n)})}return{init:t,open:e}}(),"function"==typeof window.define&&window.define.amd&&define("utils/popup",[],function(){return toolkit.popup}),"undefined"==typeof toolkit&&(toolkit={}),toolkit.tabs=function(e){function t(){a.rememberState?e.register(n(),i):o.tabs.on("click",function(e){e.preventDefault(),i($(this).find("a").attr("href"))})}function n(){var e=[];return o.tabs.each(function(){e.push($(this).attr("aria-controls"))}),e}function i(e){o.tabTargets.add(o.tabs).removeClass("selected"),$("#"+e+"-tab").add($("#"+e)).addClass("selected")}var o={tabContainer:$("section[data-function=tabs]"),tabs:$("section[data-function=tabs] li[role=tab]"),tabTargets:$("section[data-function=tabs] div[role=tabpanel]")},a={rememberState:"true"===o.tabContainer.attr("data-remember-state")};return t(),{getHashList:n,changeTab:i}}(toolkit.hashmanager),"function"==typeof window.define&&window.define.amd&&define("modules/tabs",["utils/hashmanager"],function(){return toolkit.tabs}),"undefined"==typeof toolkit&&(toolkit={}),toolkit.share=function(){function e(){i.shareCount.on("click keypress",t)}function t(e){e.preventDefault();var t=$(this).parent(),n="keypress "+("ontouchend"in document.documentElement?"touchend":"click");("click"===e.type||"touchend"===e.type||"keypress"===e.type&&13===e.which)&&(t.toggleClass("active"),i.document.on(n,function o(e){$.contains(t[0],e.target)||(t.removeClass("active"),i.document.off(n,o))}))}function n(){e()}var i={document:$(document),shareCount:$(".share-popup .summary")};return{init:n,toggleSharePopover:t}}(),"function"==typeof window.define&&window.define.amd&&define("modules/share",[],function(){return toolkit.share}),"undefined"==typeof toolkit&&(toolkit={}),toolkit.carousel=function(e,t){function n(e,t){this.options=t,this.$viewport=e,this.$slideContainer=e.find(".skycom-carousel-container"),this.$slides=this.$slideContainer.find(">"),this.currentIndex=0,this.slideCount=this.$slides.length,this.timerId=!1,this.touchReset(),this.bindEvents()}function i(e,t){this.carousel=e,this.wrapper=e.$viewport.find(".video-wrapper"),this.wrapper.attr("id","video-"+t.videoId),this.videocontrolcontainer=e.$viewport.find(".videocontrolcontainer"),this.player=e.$viewport.find("video"),this.videocontrolcontainer.find("img").on("error",function(){this.src=t.placeHolderImage}),this.options=t,this.bindEvents()}var o=function(){return"WebKitCSSMatrix"in e&&"m11"in new e.WebKitCSSMatrix}(),a=function(){var e=document.body.style;return void 0!==e.transform||void 0!==e.WebkitTransform||void 0!==e.MozTransform||void 0!==e.OTransform}();n.prototype={unbindTouchEvents:function(){this.$slideContainer.off("touchstart touchmove touchend touchcancel")},bindTouchEvents:function(){this.$slideContainer.on("touchstart",this.touchstart.bind(this)).on("touchmove",this.touchmove.bind(this)).on("touchend",this.touchend.bind(this)).on("touchcancel",this.touchReset.bind(this))},bindEvents:function(){this.bindTouchEvents(),this.$slideContainer.find("a").on("click",this.pause.bind(this))},unbindEvents:function(){this.unbindTouchEvents(),this.$slideContainer.find("a").off("click")},setOffset:function(e,t){var n=this.$slideContainer.removeClass("animate");return t&&n.addClass("animate"),o?n.css("transform","translate3d("+e+"%,0,0) scale3d(1,1,1)"):a?n.css("transform","translate("+e+"%,0)"):t?n.animate({left:2*e+"%"},600):n.css({left:2*e+"%"}),this},moveSlide:function(e){var t,n,i=this,o=this.$slides;return n=e.index>=this.slideCount?0:e.index<0?this.slideCount-1:e.index,t=e.index>this.currentIndex&&!e.reverse?"left":"right",o.filter(":not(:eq("+this.currentIndex+"))").hide(),o.eq(this.currentIndex).css("float",t),o.eq(n).show().css("float","left"==t?"right":"left"),this.setOffset(e.start,!1),"undefined"!=typeof e.end&&(setTimeout(function(){i.setOffset(e.end,!0),i.$viewport.trigger("change",n)},20),this.currentIndex=n,"function"==typeof e.callback&&e.callback(n)),n},"goto":function(e,t,n){return t!==!1&&this.pause(),e!==this.currentIndex?(e>this.currentIndex?this.moveSlide({index:e,start:0,end:-50,callback:n}):this.moveSlide({index:e,start:-50,end:0,callback:n}),this):void 0},next:function(e,t){return this.goto(this.currentIndex+1,e,t),this.$viewport.find(".indicators, .actions").css("display","block"),this},previous:function(){return this.goto(this.currentIndex-1),this.$viewport.find(".indicators, .actions").css("display","block"),this},play:function(e,t){var n=this,i=this.options.interval;return n.timerId=setTimeout(function(){n.next(!1),n.timerId=setTimeout(function e(){n.next(!1,function(){n.timerId=setTimeout(e,i)})},i)},t||this.options.onPlayDelay),this.$viewport.trigger("playing"),"function"==typeof e&&e(),this},pause:function(e){return clearTimeout(this.timerId),this.$viewport.trigger("paused"),"function"==typeof e&&e(),this},touchstart:function(e){var t=e.originalEvent.touches[0];this.pause(),this.swipe.start={x:t.pageX,y:t.pageY}},touchmove:function(e){var t,n=this.swipe,i=e.originalEvent.touches[0],o=i.pageX-n.start.x,a=i.pageY-n.start.y,s=Math.abs(o)>Math.abs(a),r=0>o?this.currentIndex+1:this.currentIndex-1;n.start&&s!==!1&&(e.preventDefault(),t=100*(o/this.$slideContainer.outerWidth(!0)),o>0&&(t-=50),this.swipe.positionAsPercentage=t,this.moveSlide({index:r,start:t}))},touchend:function(e){if(this.swipe.start){var t=this.swipe,n=t.positionAsPercentage,i=e.originalEvent.changedTouches[0],o=i.pageX-t.start.x,a=null,s=75;if(Math.abs(o)>s&&(a=0>o?"left":"right"),"left"===a)this.moveSlide({index:this.currentIndex+1,start:n,end:-50}),this.$viewport.find(".next").trigger("toolkit.track");else if("right"===a)this.moveSlide({index:this.currentIndex-1,start:n,end:0}),this.$viewport.find(".previous").trigger("toolkit.track");else if(0!==n){var r,c=o>0?n+50:n,d=this.currentIndex,l=0;0>c?this.currentIndex=d+1>=this.slideCount?0:d+1:(this.currentIndex-=1,l=-50,c-=50),r=0===this.currentIndex&&d===this.slideCount-1,this.moveSlide({index:d,start:c,end:l,reverse:r})}this.touchReset()}},touchReset:function(){this.swipe={start:!1,positionAsPercentage:0}}},i.prototype={bindEvents:function(){var e=this,t=function(e){e.preventDefault()},n=function(){return e.stop(),i.off("click",t),!1},i=this.wrapper;i.on("click",t).find(".close").one("click touchstart",n),this.player.on("ended webkitendfullscreen",n)},play:function(){var e=this,t=this.carousel.$viewport.find(".actions, .indicators");this.originalHtml=this.videocontrolcontainer.html(),this.carousel.pause(),this.showCanvas(function(){t.hide(),e.carousel.unbindTouchEvents(),e.player.sky_html5player(e.options),setTimeout(function(){sky.html5player.play()},1333)})},stop:function(){var n=this,i=this.carousel.$viewport.find(".actions, .indicators");t(e).off("skycom.resizeend",n.resizeCarousel),sky.html5player.close(this.wrapper),n.videocontrolcontainer.html(n.originalHtml),this.hideCanvas(function(){n.carousel.bindTouchEvents(),i.show()})},showCanvas:function(n){var i,o=this.carousel.$viewport,a=o.find(".video-overlay"),s=o.find(".video-wrapper"),r=o.find(".play-video"),c=o.find(".video-wrapper .close"),d=500,l=this;this.originalHeight=o.height(),s.addClass("playing-video"),a.fadeIn(function(){r.fadeOut(),i=l.calculateHeightForVideo(),o.animate({height:i},d,function(){t(e).on("skycom.resizeend",t.proxy(l.resizeCarousel,l)),s.show(),a.fadeOut(d,function(){c.addClass("active")}),n()})})},calculateHeightForVideo:function(){return Math.round(9*(this.carousel.$viewport.width()/16))},resizeCarousel:function(){this.carousel.$viewport.animate({height:this.calculateHeightForVideo()},250)},hideCanvas:function(e){var t=this.carousel.$viewport,n=t.find(".video-overlay"),i=t.find(".video-wrapper"),o=t.find(".play-video"),a=t.find(".video-wrapper .close"),s=500,r=this.originalHeight;n.fadeIn(s,function(){a.removeClass("active"),t.animate({height:r},s,function(){t.css({height:"auto"}),e(),o.fadeIn(),n.hide(),i.fadeOut(),i.removeClass("playing-video")})})}},t.fn.skycom_carousel=function(e){var o=t.extend(!0,{carousel:{actions:[{id:"play",label:"Play Carousel"},{id:"pause",label:"Pause Carousel"},{id:"previous",label:"Previous"},{id:"next",label:"Next"}],autoplay:!0,startSlideIndex:0,onPlayDelay:500,interval:6e3},video:{token:"8D5B12D4-E1E6-48E8-AF24-F7B13050EE85",autoplay:!1,videoId:null,freewheel:!1,placeHolderImage:"//static.video.sky.com/posterframes/skychasky.jpg"}},e),a={actions:function(e,n){var i,o,a,s,r="",c=n.actions,d=n.onclick;if(n.count<=1)return this;for(a in c)s="",i=c[a].id,o=c[a].label,("next"==i||"previous"==i)&&(s=" hidden-touch "),r+='<a href="#" class="skycom-internal '+s+i+'" >',r+='<span class="icon-carousel-'+i+'"></span>'+o,("next"==i||"previous"==i)&&(r+='<span class="icon-carousel-'+i+'-over over"></span>'),r+="</a>";return e.find(".skycom-carousel-container").before('<div class="actions">'+r+"</div>"),e.find("> .actions > *").each(function(e){t(this).attr("data-action",c[e].id).on("click",function(t){d(c[e].id),t.preventDefault()})}),this},indicators:function(e,n){var i,o,a=n.count,s=n.onclick,r='<div class="indicators"><div class="container">',c=' class="active"';if(1>=a)return this;for(o=a;o--;)r+="<span"+c+' data-tracking data-tracking-label="indicator"></span>',c="";return i=t(r+"</div></div>").on("click","span",function(e){s(t(e.currentTarget).index())}),e.append(i),this},video:function(e){return e.append('<div class="video-overlay"></div>'),this}};return this.each(function(){var e=t(this),s=new n(e,o.carousel),r=function(t){a.indicators(e,{count:t.slideCount,onclick:function(e){t.goto(e)}}).actions(e,{count:t.slideCount,actions:o.carousel.actions,onclick:function(e){t[e]()}}).video(e)};r(s),e.on("click",".play-video",function(e){e.preventDefault(),o.video.videoId=t(this).attr("data-video-id"),o.carousel.videoAds&&(o.video.freewheel=!0);var n=new i(s,o.video);n.play()}).on("change",function(t,n){n=n||0,e.find(".indicators .container > *").removeClass("active").eq(n).addClass("active"),s.$slides.removeClass("active").find("a").attr("tabindex",-1),s.$slides.eq(n).addClass("active").find("a").removeAttr("tabindex")}).on("playing",function(){e.removeClass("paused").addClass("playing")}).on("paused",function(){e.removeClass("playing").addClass("paused")}).on("pause",function(){s.pause()}).on("play",function(){s.play()}).on("refresh",function(t,n){s.$slides=s.$slideContainer.find(">"),s.slideCount=s.$slides.length,e.find(".indicators").remove(),e.find(".actions").remove(),e.find(".video-overlay").remove(),r(s),n=parseInt(n,10),isNaN(n)||0>n?n=0:n>s.slideCount-1&&(n=s.slideCount-1),n>s.currentIndex?s.moveSlide({index:n,start:0,end:-50}):s.moveSlide({index:n,start:-50,end:0})}).on("keyup",function(e){switch(e.keyCode){case 9:s.pause();break;case 37:s.previous();break;case 39:s.next()}}).find(".toggle-terms").on("click",function(){s.$viewport.toggleClass("showing-tandcs")}),s.slideCount>1?(s[o.carousel.autoplay===!0?"play":"pause"](!1,o.carousel.interval),s.goto(o.carousel.startSlideIndex,!1),e.trigger("change")):s.unbindTouchEvents()})}}(window,jQuery),"function"==typeof window.define&&window.define.amd&&define("modules/carousel",[],function(){return toolkit.carousel}),"undefined"==typeof toolkit&&(toolkit={}),toolkit.datepicker=function(){function e(){p.datepicker.keyup(function(){this.value!=this.value.replace(/\D/g,"")&&(this.value=this.value.replace(/\D/g,""))}),p.datepicker.on("focus",function(){i($(this),"show")}),p.day.on("keyup",function(){p.day.val()>s(m,g)?p.day.val(s(m,g)):"00"===p.day.val()&&p.day.val("01"),2===p.day.val().length&&(y=parseInt(p.day.val(),10),k=parseInt(y,10),t())}).on("blur",function(e){p.day.val().length<2&&0!==p.day.val().length&&(y=parseInt(p.day.val(),10),k=parseInt(y,10),"00"!==p.day.val()&&"0"!==p.day.val()?p.day.val("0"+p.day.val()):p.day.val("01"),t()),e.shiftKey&&9==e.keyCode&&$(".calendar").hide()}),p.month.on("keyup",function(){p.month.val()>12&&p.month.val("12"),"00"===p.month.val()&&p.month.val("01"),2===p.month.val().length&&(m=parseInt(p.month.val(),10)-1,w=parseInt(m,10),t())}).on("blur",function(){p.month.val().length<2&&0!==p.month.val().length&&(m=parseInt(p.month.val(),10)-1,w=parseInt(m,10),"00"!==p.month.val()&&"0"!==p.month.val()?p.month.val("0"+p.month.val()):p.month.val("01"),t())}),p.year.on("keyup",function(){4===p.year.val().length&&(g=parseInt(p.year.val(),10),x=parseInt(g,10),t())}).on("blur",function(e){0===e.which&&$(".calendar").hide()}),$(".monthleft").on("click",o),$(".monthright").on("click",a),$(document).on("keyup",function(e){27==e.keyCode&&$(".calendar").hide()})}function t(){$(".monthyearval").html(v[m]+" "+g),n(s(m,g),r(m,g)),$(".daycontainer .day").on("click",function(){console.log("picked date"),y=this.innerHTML,$(".daycontainer").find(".selected").removeClass("selected"),$(this).addClass("selected"),p.day.val(10>y?"0"+y:y),k=y,p.month.val(10>m+1?"0"+(m+1):m+1),w=m,p.year.val(g),x=g,$(".calendar").hide(),p.day.css("border-radius","5px"),p.month.css("border-radius","5px"),p.year.css("border-radius","5px")}),$(document).click(function(e){"datepicker"==e.target.class||$(".datepicker").find(e.target).length||$(".calendar").hide()}),console.log("rendering calendar"),console.log("values: day: "+y+". month: "+m+". year: "+g),console.log("calender vals: days in month: "+s(m+1,g)+". first day: "+r(m,g)),console.log("Input day: "+k+" input month: "+w+" input year: "+x)}function n(e,t){for(var n="",i=1;t>i;i++)n+="<span></span>";for(var o=1;e>=o;o++)n+=o==k&&m==w&&g==x?C>m&&I>=g||b>o&&C>=m&&I>=g?"<span class='past selected day'>"+o+"</span>":"<span class='selected day'>"+o+"</span>":C>m&&I>=g?"<span class='past day'>"+o+"</span>":b>o&&C>=m&&I>=g?"<span class='past day'>"+o+"</span>":"<span class='day'>"+o+"</span>";$(".daycontainer").html(n)}function i(e,t){"show"==t?e.siblings("div.calendar").show():e.siblings("div.calendar").hide()}function o(){0===m?(m=11,g--):m--,t()}function a(){11===m?(m=0,g++):m++,t()}function s(e,t){return[31,c(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]}function r(e,t){var n=new Date(t,e,1).getDay();return 0===n?7:n}function c(e){return 0===e%4&&0!==e%100||0===e%400}function d(){return(new Date).getDate()}function l(){return(new Date).getMonth()}function u(){return(new Date).getFullYear()}function h(){$(".datepicker .datepicker-container").append('<div class="calendar"><div class="monthyear"><span class="monthleft">&larr;</span><span class="monthyearval"></span><span class="monthright">&rarr;</span></div><div class="days"><span>M</span><span>T</span><span>W</span><span>T</span><span>F</span><span>S</span><span>S</span></div><div class="daycontainer"></div></div>')}function f(){h(),t(),e()}var p={datepicker:$(".datepicker input"),day:$("#day"),month:$("#month"),year:$("#year"),monthleft:$(".monthleft"),monthright:$(".monthright"),dayspan:$(".daycontainer .day"),monthyear:$(".monthyear")},v=["January","February","March","April","May","June","July","August","September","October","November","December"],y=d(),m=l(),g=u(),k=y,w=m,x=g,b=y,C=m,I=g;return{init:f}}(),"function"==typeof window.define&&window.define.amd&&define("modules/datepicker",[],function(){return toolkit.datepicker}),"undefined"==typeof toolkit&&(toolkit={}),toolkit.main=function(){function e(){var e=function(){$(document.body).addClass("window-loaded")},t=setTimeout(e,5e3);$(window).load(function(){clearTimeout(t),e()})}e()}(),toolkit.modules=function(){var e=function(e){var t,n=$.extend({skycons:!1,share:!1,popup:!1,datepicker:!1},e);for(t in n)(n[t]||!e)&&toolkit[t]&&toolkit[t].init&&toolkit[t].init()};return{init:e}}(),"function"==typeof window.define&&window.define.amd&&define("modules",[],function(){return toolkit.modules}),"function"==typeof window.define&&window.define.amd&&define("toolkit",["utils/skycons","utils/hashmanager","utils/popup","modules","modules/tabs","modules/share","modules/carousel","modules/datepicker"],function(e,t,n,i,o,a,s,r){return{modules:i,skycons:e,hashmanager:t,popup:n,tabs:o,share:a,carousel:s,datepicker:r}}),"function"==typeof window.define&&window.define.amd&&define("wiki",["toolkit"],function(e){function t(){$("#hero").skycom_carousel({carousel:{autoplay:!0,videoAds:!1}}),e.modules.init()}function n(){return console.group?(console.group($($("h1").get(0)).text()),$(".wiki-section").each(function(){var e=$(this);e.find("> h2").text()&&console.groupCollapsed(e.find("> h2").text()),i(e),e.find(".sub-section").each(function(){var e=$(this);e.find("> h3").text()&&console.groupCollapsed(e.find("> h3").text()),i(e),e.find(".example").each(function(){var e=$(this);e.find("> h4").text()&&console.groupCollapsed(e.find("> h4").text()),i(e),e.find("> h4").text()&&console.groupEnd()}),e.find("> h3").text()&&console.groupEnd()}),e.find("> h2").text()&&console.groupEnd()}),console.groupEnd(),void 0):(console.log("Please use a real browser for developer notes"),void 0)}function i(e){var t=e.find("> .developer-notes"),n=e.find("> .dependencies").html(),i=e.find("> .init").html();t.each(function(){a($(this).html())}),a(n,"Dependencies"),a(i,"Initialisation"),o(e)}function o(e){var t=e.find("> .demo").attr("data-selector"),n=e.find("> .demo > "+t).not(".developer-notes");n.each(function(){a(this.outerHTML,"'"+this.tagName+"' html")})}function a(e,t){e&&e.trim().length&&(t&&console.groupCollapsed(t),console.log.apply(console,s(e.trim())),t&&console.groupEnd())}function s(e){var t=null===e.match(/<code>/gi)?0:e.match(/<code>/gi).length,n=e.replace(/<code>/gi,"%c").replace(/<\/code>/gi,"%c"),i=[n];if(n.indexOf("%c")>-1)for(var o=0;t>o;o++)i.push("background: #FDF6E3; color: #777;"),i.push("background:white; color:black;");return i}console&&n(),t()});
//# sourceMappingURL=wiki.js.map