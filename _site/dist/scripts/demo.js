"undefined"==typeof toolkit&&(toolkit={}),toolkit.hashManager=function(){function t(){$(window).on("hashchange",e);var t=document.documentMode,n="onhashchange"in window&&(void 0===t||t>7);n||(c.hash=document.location.hash,setInterval(function(){document.location.hash!==c.hash&&$(window).trigger("hashchange")},200)),c.windowLoaded=!0}function e(t){var e,n;t=l("string"==typeof t?t:location.hash),t?(e=c.globalHashList[t],n="callback",c.lastExecutor=t):c.lastExecutor&&(e=c.globalHashList[c.lastExecutor],n="undo"),e&&"function"==typeof e[n]?e[n](t):"callback"===n&&c.fallback.callback?c.fallback.callback(t):"undo"===n&&c.fallback.undo&&c.fallback.undo(t)}function n(){var t=window.location;"pushState"in history?(location.hash="!",history.pushState("",document.title,t.pathname+t.search)):location.hash="!"}function o(t){location.hash="!"+t}function i(t,n,o){var i=c.globalHashList;$(t).each(function(t,a){if(a=l(a),i[a]){var s="hashManager: hash ("+a+") already exists";throw new Error(s)}i[a]={callback:n,undo:o},c.windowLoaded&&a===l(location.hash)&&e(a)})}function a(){c.globalHashList=[]}function s(t,e){c.fallback.callback=t,c.fallback.undo=e}function l(t){return t.replace(/[#!]/g,"")}var c={globalHashList:{},hasLoaded:!1,windowLoaded:!1,lastExecutor:null,hash:null,fallback:{callback:null,undo:null}};return t(),{register:i,registerFallback:s,change:o,remove:n,onHashChange:e,resetHash:a,cleanHash:l}},"function"==typeof window.define&&window.define.amd?define("utils/hashManager",[],function(){return toolkit.hashManager()}):toolkit.hashManager=toolkit.hashManager(),"undefined"==typeof toolkit&&(toolkit={}),toolkit.focus=function(){function t(){$(document).on("click keyup",i).on("keydown",o).on("focus","a, input, button, select, *[tabindex]",e).on("blur","a, input, button, select, *[tabindex]",n)}function e(t){s&&$(t.currentTarget).addClass(l)}function n(t){$(t.currentTarget).removeClass(l)}function o(t){var e=window.event?event.keyCode:t.keyCode;9==e&&(s=!0)}function i(t){var e=window.event?event.keyCode:t.keyCode;9==e&&(s=!1)}function a(t){$(t).addClass(l),t.focus()}var s=!1,l="has-focus";return t(),{apply:a,className:l}},"function"==typeof window.define&&window.define.amd?define("utils/focus",[],function(){return toolkit.focus()}):toolkit.focus=toolkit.focus(),"undefined"==typeof toolkit&&(toolkit={}),toolkit.lightbox=function(t,e,n){function o(e,n){var o=t(n);o.attr("data-tabindex",o.attr("tabindex")),o.attr("tabindex",-1)}function i(e,n){var o=t(n);o.attr("data-tabindex")?(o.attr("tabindex",o.attr("data-tabindex")),o.removeAttr("data-tabindex")):o.removeAttr("tabindex")}function a(){t("a, input, select, textarea, button, *[tabindex]").each(o)}function s(t){t.find("*[tabindex]").each(i)}function l(t){t&&t.focus()}function c(t,n){t.hasClass(e.className)?e.apply(n[0]):n[0].focus()}function d(){t("body").css({overflow:"hidden","padding-right":f+"px"})}function r(){t("body").removeAttr("style")}function h(e,n,o){var i=t("#"+e.replace("lightbox/",""));this.id=e,this.$container=i.hasClass(u.main)?i:i.closest("."+u.main),this.$contents=this.$container.length?this.$container.find("."+u.content):i,this.$closeIcon=this.$container.find("."+u.closeButton),this.$lightboxLink=n,this.$container.length||(this.create(),this.bindEvents()),o&&(this.onShow=o.onShow,this.onClose=o.onClose)}var u={main:"lightbox",closing:"lightbox-closing",content:"lightbox-content",closeButton:"lightbox-close",open:"lightbox-open"},f=function(){var t,e=document.createElement("div");return e.className="lightbox-scrollbar-measure",document.body.appendChild(e),t=e.offsetWidth-e.clientWidth,document.body.removeChild(e),t}();h.prototype={bindEvents:function(){n.register([this.id],this.open.bind(this)),this.$lightboxLink.on("click",this.open.bind(this)),this.$container.on("click",this.close.bind(this)),this.$closeIcon.on("click",this.close.bind(this)),this.$contents.on("click",function(){return!1})},create:function(){var e=this.$contents,n=this.$contents.parent(),o=t('<div class="'+u.main+'"></div>'),i=t('<div class="skycom-container lightbox-container clearfix"></div>'),a=t('<a class="internal-link '+u.closeButton+' skycon-close" href="#!"><span class="speak">Close</span></a>');e.addClass(u.content+" skycom-10 skycom-offset1").attr("role","dialog"),e.prepend(a),i.append(e),o.append(i),n.append(o),this.$container=o,this.$closeIcon=a},open:function(){this.$container.hasClass(u.open)||(this.onShow&&this.onShow(),d(),this.$container.addClass(u.open),c(this.$lightboxLink,this.$closeIcon),a(),s(this.$container))},close:function(e){var o=this;e.preventDefault(),this.$container.hasClass(u.closing)||(this.$container.addClass(u.closing),n.remove(),window.setTimeout(function(){o.$container.removeClass(u.open+" "+u.closing),l(o.$lightboxLink),r(),s(t("body")),o.onClose&&o.onClose()},500))}},t.fn.lightbox=function(e){return this.each(function(){new h(t(this).attr("href").replace("#!",""),t(this),e)})}},"function"==typeof window.define&&window.define.amd?define("components/lightbox",["utils/focus","utils/hashManager"],function(t,e){return toolkit.lightbox(jQuery,t,e)}):toolkit.lightbox=toolkit.lightbox(jQuery,toolkit.focus,toolkit.hashManager),"undefined"==typeof toolkit&&(toolkit={}),toolkit.displayCode=function(){function t(t){var e=t.feature,n=t.fileNames,i=t.dir,a=t.styled;new o({feature:e,fileNames:n.split(","),dir:i,styled:a})}function e(t,e,n){var o=$(n.replace(/{{ site.version }}/g,$("h1.wiki-header small").text().replace("v","").trim()));$(document.getElementById(t+e+"-table")).append(o)}function n(t,e,n,o){var i=document.getElementById(t+e+"-table"),a=document.createElement("tr"),s=document.createElement("td"),l=document.createElement("td"),c=document.createTextNode(n),d=document.createTextNode(o);s.className="codekolom",l.className="bredecode",s.appendChild(c),l.appendChild(d),a.appendChild(s),a.appendChild(l),i.appendChild(a)}function o(t){this.feature=t.feature,this.dir=t.dir,this.fileNames=t.fileNames,this.styled=t.styled,this.$lightboxLink=$('a[href*="#!lightbox/code-'+this.feature+'"]'),$("#code-"+this.feature).length||this.getCode()}return o.prototype.getCode=function(){this.getFile(this.dir,"notes","html",!0);for(var t in this.fileNames)this.getFile(this.dir,this.fileNames[t],"html"),this.getFile(this.dir,this.fileNames[t],"notes.html",!0),this.getFile(this.dir,this.fileNames[t],"js"),this.getFile(this.dir,this.fileNames[t],"require.js")},o.prototype.getFile=function(t,e,n,o){var i=this,a=$.ajax({crossDomain:!0,cache:!1,url:t+"/"+e+"."+n});a.always(function(t){i[i.feature+"-"+e+n]="string"==typeof t?t:"",i.addToPage(e,n,o)})},o.prototype.addToPage=function(t,e,n){this.$container=this.$lightboxLink.parent().parent().find(".code-container"),this.$tabList=this.$container.find(".tab-list"),this.addContainer(),this.addTab(t,e,n),this.show(t,e,n),this.bindEvents(),this.$lightboxLink.lightbox()},o.prototype.addContainer=function(){this.$container.length||(this.$container=$('<div class="code-container" id="code-'+this.feature+'"><h3 class="code-h3">'+this.feature+'</h3><div id="'+this.feature+'-noteshtml-table" class="feature-notes"></div></div>'),this.$tabList=$('<ul class="tab-list clearfix" ></ul>'),this.$container.append(this.$tabList),this.$lightboxLink.parent().parent().append(this.$container))},o.prototype.createTable=function(t,e,n){var o=this.feature+"-"+t+e+"-table";return this.styled||n?$('<div id="'+o+'" class="styled '+e+'"></div> '):$("<table class="+e+'><thead><tr><th colspan="3">'+e.toUpperCase()+'</th></tr></thead><tbody id="'+o+'"></tbody></table> ')},o.prototype.addTab=function(t,e){var n=this.feature+"-"+t;if(!this.$container.find("#"+n+"-tab").length&&"notes"!==t){var o=$('<li for="'+n+'-tab">'+(t?t:"default")+"</li>");this.$tabList.append(o);var i=$('<div class="tab hidden" id="'+n+'-tab"></div>');i.append(this.createTable(t,"notes.html",e)).append(this.createTable(t,"html")).append(this.createTable(t,"require.js")).append(this.createTable(t,"js")),this.$container.append(i)}},o.prototype.changeTab=function(){var t=$(this);t.closest(".code-container").find(".tab-list > li").removeClass("medium"),t.closest(".code-container").find(".tab").addClass("hidden"),$("#"+t.attr("for")).removeClass("hidden"),t.addClass("medium")},o.prototype.bindEvents=function(){this.$tabList.on("click","li",this.changeTab),this.$tabList.find("li").first().click()},o.prototype.show=function(t,o,i){var a=this.feature+"-"+t;if(this.styled||i)e(a,o,this[a+o]);else{var s=this[a+o]?this[a+o].split("\n"):"";for(var l in s){var c=s[l];n(a,o,parseInt(l,10)+1,c)}}},t},"function"==typeof window.define&&window.define.amd?define("utils/displayCode",["components/lightbox"],function(t){return toolkit.displayCode(t)}):toolkit.displayCode=toolkit.displayCode(toolkit.lightbox);var demo=function(t){function e(){$(document).on("click",".toggler",a),$(document).on("click",".code-download",o),$(".sky-form").on("submit",n)}function n(t){t.preventDefault();var e,n=$("#version").val(),o=$(".wiki-header small").text().replace("v",""),i="http://web-toolkit.global.sky.com",a=e="_site/_includes";0===location.hostname.indexOf("local")&&(i="http://"+location.host,e="../_includes"),(n.split(".").length<3||n.split(".")[0]<1)&&$(".sky-form .error").text("The version number is required, and must be '1.0.0' or higher"),(1===parseFloat(n,10)||"0"===n.split(".")[0])&&(n="0.6.9"),window.toolkit.diff({oldRoute:i+"/"+n+"/"+a,newRoute:i+"/"+o+"/"+e})}function o(){var t=!1,e=$(this).attr("href").replace("#!lightbox/code-",""),n=$(".wiki-header small").text().replace("v","").trim(),o="http://web-toolkit.global.sky.com",i="_site/_includes";0===location.hostname.indexOf("local")&&(o="http://"+location.host,i="../_includes");var a,s,l;$(this).attr("data-docs")?(a=$(this).attr("data-docs"),s=e,l=o+"/"+n+"/"+i+"/"+s,t=!0):(a=$('a[href*="#'+e+'"]').attr("data-diff-demos"),s=$('a[href*="#'+e+'"]').attr("data-diff"),l=o+"/"+n+"/"+i+"/"+s),window.toolkit.displayCode({feature:e,dir:l,fileNames:a,styled:t})}function i(){var t=[],e=$("#wiki-skycons tbody tr");e.each(function(e){t.push({i:e,skycon:$(this).find("td").first().text().trim()})}),t.sort(function(t,e){return t.skycon>e.skycon?1:t.skycon<e.skycon?-1:0}),$("#wiki-skycons tbody tr").remove();for(var n=0;n<t.length;n++)$("#wiki-skycons tbody").append($(e[t[n].i]))}function a(){var t=$(this),e=$("div[data-toggle="+t.attr("for")+"]");e.hasClass("open")?(t.removeClass("open"),e.removeClass("open")):(t.addClass("open"),e.addClass("open"))}function s(t,e){var n=e.find(".failures em").text();"0"===n?t.append("<span class='dev-button result-summary'><i class='skycon-tick colour' aria-hidden='true'></i> Tests Passed</span>"):t.append("<span class='dev-button result-summary error'><i class='skycon-warning colour' aria-hidden='true'></i> Tests Failed</span>")}function l(t,e){t.preventDefault();var n=$(t.target).hasClass("lightbox-close")||!$(t.target).hasClass("lightbox-content")&&!$(t.target).parents(".lightbox-content").length;n&&e.hide().removeClass("lightbox-open")}function c(t){t.show().addClass("lightbox-open")}function d(t,e){var n=document.createElement("div"),o=document.createElement("div"),i=document.createElement("article"),a=$('<a class="internal-link lightbox-close skycon-close black" href="#"><span class="speak">Close</span></a>');n.className="lightbox",n.id=e+"-lightbox",o.className="skycom-container lightbox-container clearfix",i.className="lightbox-content skycom-10 skycom-offset1",$(i).append(a),$(i).append(t.find("#mocha-stats")),$(i).append(t.find("#mocha-report")),$(o).append($(i)),$(n).append($(o)),t.append($(n)),c($("#"+e+"-lightbox")),a.add($(n)).on("click",function(t){l(t,$("#"+e+"-lightbox"))})}function r(t){var e=t.replace("test/",""),n=document.createElement("script");n.src="/test/specs/"+e+".js",n.onload=function(){var n=$('a[href*="#'+t+'"]'),o=$('<div id="mocha" class="mocha-container"></div>');n.parent().after(o);var i=window[e]();mocha.grep(i),mocha.run(function(){s(n,o),o.attr("id","mocha-"+e)}),n.removeAttr("href"),$("html, body").animate({scrollTop:o.parent().prev().offset().top},200),d(o,e),n.on("click",function(){c($("#"+e+"-lightbox"))})},document.head.appendChild(n)}function h(){if(!window.require||!window.describe)return setTimeout(h,250),void 0;var e=[];$(".run-test").each(function(){e.push($(this).attr("href").split("#")[1])}),t.register(e,r)}e(),i(),h()};"function"==typeof window.define&&window.define.amd?define("demo",["utils/hashManager","components/lightbox","utils/displayCode"],function(t,e,n){return demo(t,e,n)}):demo(toolkit.hashManager,toolkit.lightbox,toolkit.displayCode);